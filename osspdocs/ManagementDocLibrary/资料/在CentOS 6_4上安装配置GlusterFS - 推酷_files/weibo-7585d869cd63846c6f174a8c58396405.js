function check_repost_status(t){$.ajax({url:"/status/check_repost?id="+t,success:function(t){$("#repost_pop_modal").html(t),$("#repost_pop_modal").modal("show")}})}function handle_repost_status(t){var e=$("#text11").val(),a=0;$("#repost_comment").attr("checked")=="checked"&&(a=3),$.ajax({url:"/status/repost?id="+t+"&text="+e+"&comment="+a,success:function(t){$("#repost_pop_modal").html(t),$("#repost_pop_modal").modal("show")}})}function favorite_status(t){$.ajax({url:"/status/favorite_status?id="+t,success:function(e){"yes"==e?$("#tw-"+t).find(".favorite a").text("取消收藏").attr("href","javascript:unfavorite_status("+t+")"):($("#repost_pop_modal").html(e),$("#repost_pop_modal").modal("show"))}})}function unfavorite_status(t){$.ajax({url:"/status/unfavorite_status?id="+t,success:function(e){"yes"==e?$("#tw-"+t).find(".favorite a").text("收藏").attr("href","javascript:favorite_status("+t+")"):($("#repost_pop_modal").html(e),$("#repost_pop_modal").modal("show"))}})}function do_like_status(t){like_style="message_like",unlike_style="message_unlike";var e=$("#tw-"+t).find(".fav-action");window.aa=e,$.ajax({url:"/status/do_like?id="+t,success:function(t){parseInt(t)==1&&(trim(e.text())=="喜欢"?e.text("取消喜欢"):e.text("喜欢"))}})}function load_my_follow(t){try{req.abort(),spinner.stop(),$("#spinner").hide()}catch(e){}follow_user_pn=t,0==follow_user_pn?(window.spinner=new Spinner(opts).spin(target),$("ul.my_followed").empty(),$(".tttttip").empty(),$(".loadmore").hide()):$("#spinner").show(),req=$.getJSON("/weibo/users/follow?pn="+follow_user_pn,function(t){t.success?(t.data.length>-1&&(t.data.length<=6&&$(".tttttip").html("<div class='alert alert-success'>为了使推酷更好地推荐微博给你，你可以关注一些感兴趣的微博帐号到推酷，以使推酷更懂你，更有针对性地进行推荐。目前你可以在微博推荐页面进行关注。<img src='/images/fo.png'></div>"),follow_user_pn+=1,$(".loadmore").attr("href","javascript:load_my_follow("+follow_user_pn+")"),$.each(t.data,function(t,e){$("ul.my_followed").append("<li><div class='uaimg'><a href='http://weibo.com/u/"+e.id+"' target='_blank'><img src='"+e.img+"'><span>"+e.name+"</span> </a><div class='action_flag'><i class='icon-ok'></i><span>已关注</span></div>  </div><div class='desc cut'>简介："+e.desc+" </div><div class='user_action' id='ac-"+e.id+"'><a href='javascript:cancel_follow("+e.id+");' class='cancel'>取消关注</a></div></li>")})),t.has_more?$(".loadmore").show():$(".loadmore").hide(),spinner.stop(),$("#spinner").hide()):loadfail()})}function load_my_block(t){try{req.abort(),spinner.stop(),$("#spinner").hide()}catch(e){}block_user_pn=t,0==block_user_pn?(window.spinner=new Spinner(opts).spin(target),$("ul.my_followed").empty(),$(".tttttip").empty(),$(".loadmore").hide()):$("#spinner").show(),req=$.getJSON("/weibo/users/block?pn="+block_user_pn,function(t){t.success?(t.data.length>-1&&(t.data.length<=3&&$(".tttttip").html("<div class='alert alert-success'>如果推酷推荐给你的微博中，有你不想看到的微博帐号，可以将其屏蔽，这样推酷将不会再推荐该帐号的微博给你。恩，还是要有节制的使用改功能哦。<img src='/images/ban.png'></div>"),block_user_pn+=1,$(".loadmore").attr("href","javascript:load_my_block("+block_user_pn+")"),$.each(t.data,function(t,e){$("ul.my_followed").append("<li><div class='uaimg'><a href='http://weibo.com/u/"+e.id+"' target='_blank'><img src='"+e.img+"'><span>"+e.name+"</span> </a><div class='action_flag'><i class='icon-ban-circle'></i><span>已屏蔽</span></div>  </div><div class='desc cut'>简介："+e.desc+" </div><div class='user_action' id='ac-"+e.id+"'><a href='javascript:cancel_block("+e.id+");' class='cancel'>取消屏蔽</a></div></li>")})),t.has_more?$(".loadmore").show():$(".loadmore").hide(),spinner.stop(),$("#spinner").hide()):loadfail()})}function cancel_follow(t){$.ajax({url:"/weibo/users/cancel_follow",type:"POST",beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{id:t},success:function(e){e.success?$("#ac-"+t).find(".cancel").text("关注").attr("href","javascript:do_follow("+t+")").attr("class","follow"):loadfail()},error:function(){loadfail()}})}function cancel_block(t){$.ajax({url:"/weibo/users/cancel_block",type:"POST",beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{id:t},success:function(e){e.success?$("#ac-"+t).find(".cancel").text("屏蔽").attr("href","javascript:do_block("+t+")").attr("class","block"):loadfail()},error:function(){loadfail()}})}function do_follow(t){$.ajax({url:"/weibo/users/do_follow",type:"POST",beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{id:t},success:function(e){e.success?$("#ac-"+t).find(".follow").text("取消关注").attr("href","javascript:cancel_follow("+t+")").attr("class","cancel"):loadfail()},error:function(){loadfail()}})}function do_block(t){$.ajax({url:"/weibo/users/do_block",type:"POST",beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{id:t},success:function(e){e.success?$("#ac-"+t).find(".block").text("取消屏蔽").attr("href","javascript:cancel_block("+t+")").attr("class","cancel"):alert("Error!")},error:function(){alert("Error!")}})}function loadfail(){try{spinner.stop()}catch(t){}$("#flash_container").html("<div class='alert'><a class='close' data-dismiss='alert'>&times;</a>加载失败，请重新刷新页面</div>")}